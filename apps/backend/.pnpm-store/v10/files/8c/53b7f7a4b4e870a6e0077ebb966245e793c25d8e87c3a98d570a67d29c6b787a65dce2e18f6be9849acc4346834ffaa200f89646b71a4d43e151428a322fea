{"version":3,"file":"index.js","names":["c","_c","useDroppable","React","DocumentIcon","ThreeDotsIcon","useFolder","Popup","Thumbnail","ColoredFolderIcon","DraggableWithClick","baseClass","FolderFileCard","id","type","className","disabled","isDeleting","isFocused","isSelected","itemKey","onClick","onKeyDown","PopupActions","previewUrl","selectedCount","title","disableDrop","isOver","setNodeRef","data","ref","useRef","useEffect","copyOfRef","current","focus","blur","_jsxs","filter","Boolean","join","_jsx","fileSrc","button","horizontalAlign","size","verticalAlign","ContextFolderFileCard","t0","$","index","item","focusedRowIndex","isDragging","itemKeysToMove","onItemClick","onItemKeyPress","selectedItemKeys","t1","has","t2","event","t3","event_0","value","url","_folderOrDocumentTitle"],"sources":["../../../../src/elements/FolderView/FolderFileCard/index.tsx"],"sourcesContent":["'use client'\n\nimport type { FolderOrDocument } from 'payload/shared'\n\nimport { useDroppable } from '@dnd-kit/core'\nimport React from 'react'\n\nimport { DocumentIcon } from '../../../icons/Document/index.js'\nimport { ThreeDotsIcon } from '../../../icons/ThreeDots/index.js'\nimport { useFolder } from '../../../providers/Folders/index.js'\nimport { Popup } from '../../Popup/index.js'\nimport { Thumbnail } from '../../Thumbnail/index.js'\nimport { ColoredFolderIcon } from '../ColoredFolderIcon/index.js'\nimport { DraggableWithClick } from '../DraggableWithClick/index.js'\nimport './index.scss'\n\nconst baseClass = 'folder-file-card'\n\ntype Props = {\n  readonly className?: string\n  readonly disabled?: boolean\n  readonly id: number | string\n  readonly isDeleting?: boolean\n  readonly isFocused?: boolean\n  readonly isSelected?: boolean\n  readonly itemKey: string\n  readonly onClick?: (e: React.MouseEvent) => void\n  readonly onKeyDown?: (e: React.KeyboardEvent) => void\n  readonly PopupActions?: React.ReactNode\n  readonly previewUrl?: string\n  readonly selectedCount?: number\n  readonly title: string\n  readonly type: 'file' | 'folder'\n}\nexport function FolderFileCard({\n  id,\n  type,\n  className = '',\n  disabled = false,\n  isDeleting = false,\n  isFocused = false,\n  isSelected = false,\n  itemKey,\n  onClick,\n  onKeyDown,\n  PopupActions,\n  previewUrl,\n  selectedCount = 0,\n  title,\n}: Props) {\n  const disableDrop = !id || disabled || type !== 'folder'\n  const { isOver, setNodeRef } = useDroppable({\n    id: itemKey,\n    data: {\n      id,\n      type,\n    },\n    disabled: disableDrop,\n  })\n  const ref = React.useRef(null)\n\n  React.useEffect(() => {\n    const copyOfRef = ref.current\n    if (isFocused && ref.current) {\n      ref.current.focus()\n    } else if (!isFocused && ref.current) {\n      ref.current.blur()\n    }\n\n    return () => {\n      if (copyOfRef) {\n        copyOfRef.blur()\n      }\n    }\n  }, [isFocused])\n\n  return (\n    <div\n      className={[\n        baseClass,\n        className,\n        isSelected && `${baseClass}--selected`,\n        disabled && `${baseClass}--disabled`,\n        isDeleting && `${baseClass}--deleting`,\n        isFocused && `${baseClass}--focused`,\n        isOver && `${baseClass}--over`,\n        `${baseClass}--${type}`,\n      ]\n        .filter(Boolean)\n        .join(' ')}\n      key={itemKey}\n    >\n      {!disabled && (onClick || onKeyDown) && (\n        <DraggableWithClick\n          className={`${baseClass}__drag-handle`}\n          id={itemKey}\n          key={itemKey}\n          onClick={onClick}\n          onKeyDown={onKeyDown}\n          ref={ref}\n        />\n      )}\n      {!disableDrop ? <div className={`${baseClass}__drop-area`} ref={setNodeRef} /> : null}\n\n      {type === 'file' ? (\n        <div className={`${baseClass}__preview-area`}>\n          {previewUrl ? <Thumbnail fileSrc={previewUrl} /> : <DocumentIcon />}\n        </div>\n      ) : null}\n\n      <div className={`${baseClass}__titlebar-area`}>\n        <div className={`${baseClass}__icon-wrap`}>\n          {type === 'file' ? <DocumentIcon /> : <ColoredFolderIcon />}\n        </div>\n        <p className={`${baseClass}__name`} title={title}>\n          <span>{title}</span>\n        </p>\n        {PopupActions ? (\n          <Popup\n            button={<ThreeDotsIcon />}\n            disabled={selectedCount > 1 || (selectedCount === 1 && !isSelected)}\n            horizontalAlign=\"right\"\n            size=\"large\"\n            verticalAlign=\"bottom\"\n          >\n            {PopupActions}\n          </Popup>\n        ) : null}\n      </div>\n    </div>\n  )\n}\n\ntype ContextCardProps = {\n  readonly className?: string\n  readonly index: number // todo: possibly remove\n  readonly item: FolderOrDocument\n  readonly type: 'file' | 'folder'\n}\nexport function ContextFolderFileCard({ type, className, index, item }: ContextCardProps) {\n  const {\n    focusedRowIndex,\n    isDragging,\n    itemKeysToMove,\n    onItemClick,\n    onItemKeyPress,\n    selectedItemKeys,\n  } = useFolder()\n  const isSelected = selectedItemKeys.has(item.itemKey)\n\n  return (\n    <FolderFileCard\n      className={className}\n      disabled={(isDragging && isSelected) || itemKeysToMove.has(item.itemKey)}\n      id={item.value.id}\n      isFocused={focusedRowIndex === index}\n      isSelected={isSelected}\n      itemKey={item.itemKey}\n      onClick={(event) => {\n        void onItemClick({ event, index, item })\n      }}\n      onKeyDown={(event) => {\n        void onItemKeyPress({ event, index, item })\n      }}\n      previewUrl={item.value.url}\n      title={item.value._folderOrDocumentTitle}\n      type={type}\n    />\n  )\n}\n"],"mappings":"AAAA;;AAAA,SAAAA,CAAA,IAAAC,EAAA;;AAIA,SAASC,YAAY,QAAQ;AAC7B,OAAOC,KAAA,MAAW;AAElB,SAASC,YAAY,QAAQ;AAC7B,SAASC,aAAa,QAAQ;AAC9B,SAASC,SAAS,QAAQ;AAC1B,SAASC,KAAK,QAAQ;AACtB,SAASC,SAAS,QAAQ;AAC1B,SAASC,iBAAiB,QAAQ;AAClC,SAASC,kBAAkB,QAAQ;AACnC,OAAO;AAEP,MAAMC,SAAA,GAAY;AAkBlB,OAAO,SAASC,eAAe;EAC7BC,EAAE;EACFC,IAAI;EACJC,SAAA,GAAY,EAAE;EACdC,QAAA,GAAW,KAAK;EAChBC,UAAA,GAAa,KAAK;EAClBC,SAAA,GAAY,KAAK;EACjBC,UAAA,GAAa,KAAK;EAClBC,OAAO;EACPC,OAAO;EACPC,SAAS;EACTC,YAAY;EACZC,UAAU;EACVC,aAAA,GAAgB,CAAC;EACjBC;AAAK,CACC;EACN,MAAMC,WAAA,GAAc,CAACd,EAAA,IAAMG,QAAA,IAAYF,IAAA,KAAS;EAChD,MAAM;IAAEc,MAAM;IAAEC;EAAU,CAAE,GAAG3B,YAAA,CAAa;IAC1CW,EAAA,EAAIO,OAAA;IACJU,IAAA,EAAM;MACJjB,EAAA;MACAC;IACF;IACAE,QAAA,EAAUW;EACZ;EACA,MAAMI,GAAA,GAAM5B,KAAA,CAAM6B,MAAM,CAAC;EAEzB7B,KAAA,CAAM8B,SAAS,CAAC;IACd,MAAMC,SAAA,GAAYH,GAAA,CAAII,OAAO;IAC7B,IAAIjB,SAAA,IAAaa,GAAA,CAAII,OAAO,EAAE;MAC5BJ,GAAA,CAAII,OAAO,CAACC,KAAK;IACnB,OAAO,IAAI,CAAClB,SAAA,IAAaa,GAAA,CAAII,OAAO,EAAE;MACpCJ,GAAA,CAAII,OAAO,CAACE,IAAI;IAClB;IAEA,OAAO;MACL,IAAIH,SAAA,EAAW;QACbA,SAAA,CAAUG,IAAI;MAChB;IACF;EACF,GAAG,CAACnB,SAAA,CAAU;EAEd,oBACEoB,KAAA,CAAC;IACCvB,SAAA,EAAW,CACTJ,SAAA,EACAI,SAAA,EACAI,UAAA,IAAc,GAAGR,SAAA,YAAqB,EACtCK,QAAA,IAAY,GAAGL,SAAA,YAAqB,EACpCM,UAAA,IAAc,GAAGN,SAAA,YAAqB,EACtCO,SAAA,IAAa,GAAGP,SAAA,WAAoB,EACpCiB,MAAA,IAAU,GAAGjB,SAAA,QAAiB,EAC9B,GAAGA,SAAA,KAAcG,IAAA,EAAM,CACxB,CACEyB,MAAM,CAACC,OAAA,EACPC,IAAI,CAAC;eAGP,CAACzB,QAAA,KAAaK,OAAA,IAAWC,SAAQ,kBAChCoB,IAAA,CAAChC,kBAAA;MACCK,SAAA,EAAW,GAAGJ,SAAA,eAAwB;MACtCE,EAAA,EAAIO,OAAA;MAEJC,OAAA,EAASA,OAAA;MACTC,SAAA,EAAWA,SAAA;MACXS,GAAA,EAAKA;OAHAX,OAAA,GAMR,CAACO,WAAA,gBAAce,IAAA,CAAC;MAAI3B,SAAA,EAAW,GAAGJ,SAAA,aAAsB;MAAEoB,GAAA,EAAKF;SAAiB,MAEhFf,IAAA,KAAS,sBACR4B,IAAA,CAAC;MAAI3B,SAAA,EAAW,GAAGJ,SAAA,gBAAyB;gBACzCa,UAAA,gBAAakB,IAAA,CAAClC,SAAA;QAAUmC,OAAA,EAASnB;wBAAiBkB,IAAA,CAACtC,YAAA;SAEpD,M,aAEJkC,KAAA,CAAC;MAAIvB,SAAA,EAAW,GAAGJ,SAAA,iBAA0B;8BAC3C+B,IAAA,CAAC;QAAI3B,SAAA,EAAW,GAAGJ,SAAA,aAAsB;kBACtCG,IAAA,KAAS,sBAAS4B,IAAA,CAACtC,YAAA,qBAAkBsC,IAAA,CAACjC,iBAAA;uBAEzCiC,IAAA,CAAC;QAAE3B,SAAA,EAAW,GAAGJ,SAAA,QAAiB;QAAEe,KAAA,EAAOA,KAAA;kBACzC,aAAAgB,IAAA,CAAC;oBAAMhB;;UAERH,YAAA,gBACCmB,IAAA,CAACnC,KAAA;QACCqC,MAAA,eAAQF,IAAA,CAACrC,aAAA;QACTW,QAAA,EAAUS,aAAA,GAAgB,KAAMA,aAAA,KAAkB,KAAK,CAACN,UAAA;QACxD0B,eAAA,EAAgB;QAChBC,IAAA,EAAK;QACLC,aAAA,EAAc;kBAEbxB;WAED;;KArCDH,OAAA;AAyCX;AAQA,OAAO,SAAA4B,sBAAAC,EAAA;EAAA,MAAAC,CAAA,GAAAjD,EAAA;EAA+B;IAAAa,IAAA;IAAAC,SAAA;IAAAoC,KAAA;IAAAC;EAAA,IAAAH,EAAkD;EACtF;IAAAI,eAAA;IAAAC,UAAA;IAAAC,cAAA;IAAAC,WAAA;IAAAC,cAAA;IAAAC;EAAA,IAOIpD,SAAA;EAAA,IAAAqD,EAAA;EAAA,IAAAT,CAAA,QAAAnC,SAAA,IAAAmC,CAAA,QAAAG,eAAA,IAAAH,CAAA,QAAAC,KAAA,IAAAD,CAAA,QAAAI,UAAA,IAAAJ,CAAA,QAAAE,IAAA,IAAAF,CAAA,QAAAK,cAAA,IAAAL,CAAA,QAAAM,WAAA,IAAAN,CAAA,QAAAO,cAAA,IAAAP,CAAA,QAAAQ,gBAAA,IAAAR,CAAA,QAAApC,IAAA;IACJ,MAAAK,UAAA,GAAmBuC,gBAAA,CAAAE,GAAA,CAAqBR,IAAA,CAAAhC,OAAY;IAAA,IAAAyC,EAAA;IAAA,IAAAX,CAAA,SAAAC,KAAA,IAAAD,CAAA,SAAAE,IAAA,IAAAF,CAAA,SAAAM,WAAA;MAUvCK,EAAA,GAAAC,KAAA;QACFN,WAAA;UAAAM,KAAA;UAAAX,KAAA;UAAAC;QAAA,CAAiC;MAAA;MACxCF,CAAA,OAAAC,KAAA;MAAAD,CAAA,OAAAE,IAAA;MAAAF,CAAA,OAAAM,WAAA;MAAAN,CAAA,OAAAW,EAAA;IAAA;MAAAA,EAAA,GAAAX,CAAA;IAAA;IAAA,IAAAa,EAAA;IAAA,IAAAb,CAAA,SAAAC,KAAA,IAAAD,CAAA,SAAAE,IAAA,IAAAF,CAAA,SAAAO,cAAA;MACWM,EAAA,GAAAC,OAAA;QACJP,cAAA;UAAAK,KAAA,EAAiBA,OAAA;UAAAX,KAAA;UAAAC;QAAA,CAAmB;MAAA;MAC3CF,CAAA,OAAAC,KAAA;MAAAD,CAAA,OAAAE,IAAA;MAAAF,CAAA,OAAAO,cAAA;MAAAP,CAAA,OAAAa,EAAA;IAAA;MAAAA,EAAA,GAAAb,CAAA;IAAA;IAZFS,EAAA,GAAAjB,IAAA,CAAA9B,cAAA;MAAAG,SAAA;MAAAC,QAAA,EAEYsC,UAAC,IAAcnC,UAAA,IAAeoC,cAAA,CAAAK,GAAA,CAAmBR,IAAA,CAAAhC,OAAY;MAAAP,EAAA,EACnEuC,IAAA,CAAAa,KAAA,CAAApD,EAAA;MAAAK,SAAA,EACOmC,eAAA,KAAoBF,KAAA;MAAAhC,UAAA;MAAAC,OAAA,EAEtBgC,IAAA,CAAAhC,OAAA;MAAAC,OAAA,EACAwC,EAET;MAAAvC,SAAA,EACWyC,EAEX;MAAAvC,UAAA,EACY4B,IAAA,CAAAa,KAAA,CAAAC,GAAA;MAAAxC,KAAA,EACL0B,IAAA,CAAAa,KAAA,CAAAE,sBAAA;MAAArD;IAAA,C;;;;;;;;;;;;;;;SAdT6C,E","ignoreList":[]}