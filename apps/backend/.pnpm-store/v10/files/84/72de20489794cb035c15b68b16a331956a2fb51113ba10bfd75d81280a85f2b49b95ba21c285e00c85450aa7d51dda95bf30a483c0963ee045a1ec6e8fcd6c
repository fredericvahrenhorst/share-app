{"version":3,"file":"index.client.js","names":["CheckboxField","CopyToClipboard","Form","Gutter","MinimizeMaximizeIcon","NumberField","SetDocumentStepNav","toast","useConfig","useDocumentInfo","useLocale","useTranslation","useSearchParams","React","LocaleSelector","RenderJSON","baseClass","APIViewClient","id","collectionSlug","globalSlug","initialData","searchParams","i18n","t","code","config","defaultDepth","localization","routes","api","apiRoute","serverURL","getEntityConfig","collectionConfig","globalConfig","localeOptions","locales","map","locale","label","value","draftsEnabled","docEndpoint","Boolean","versions","drafts","data","setData","useState","draft","setDraft","get","setLocale","depth","setDepth","toString","authenticated","setAuthenticated","fullscreen","setFullscreen","params","URLSearchParams","String","fetchURL","useEffect","fetchData","res","fetch","credentials","headers","language","method","json","error","console","_jsxs","className","filter","join","right","_jsx","globalLabel","pluralLabel","labels","plural","undefined","useAsTitle","admin","view","href","rel","target","initialState","initialValue","valid","Number","field","name","onChange","path","step","max","min","onClick","type","isMinimized","object"],"sources":["../../../src/views/API/index.client.tsx"],"sourcesContent":["'use client'\n\nimport {\n  CheckboxField,\n  CopyToClipboard,\n  Form,\n  Gutter,\n  MinimizeMaximizeIcon,\n  NumberField,\n  SetDocumentStepNav,\n  toast,\n  useConfig,\n  useDocumentInfo,\n  useLocale,\n  useTranslation,\n} from '@payloadcms/ui'\nimport { useSearchParams } from 'next/navigation.js'\nimport * as React from 'react'\n\nimport './index.scss'\nimport { LocaleSelector } from './LocaleSelector/index.js'\nimport { RenderJSON } from './RenderJSON/index.js'\n\nconst baseClass = 'query-inspector'\n\nexport const APIViewClient: React.FC = () => {\n  const { id, collectionSlug, globalSlug, initialData } = useDocumentInfo()\n\n  const searchParams = useSearchParams()\n  const { i18n, t } = useTranslation()\n  const { code } = useLocale()\n\n  const {\n    config: {\n      defaultDepth,\n      localization,\n      routes: { api: apiRoute },\n      serverURL,\n    },\n    getEntityConfig,\n  } = useConfig()\n\n  const collectionConfig = getEntityConfig({ collectionSlug })\n  const globalConfig = getEntityConfig({ globalSlug })\n\n  const localeOptions =\n    localization &&\n    localization.locales.map((locale) => ({ label: locale.label, value: locale.code }))\n\n  let draftsEnabled: boolean = false\n  let docEndpoint: string = ''\n\n  if (collectionConfig) {\n    draftsEnabled = Boolean(collectionConfig.versions?.drafts)\n    docEndpoint = `/${collectionSlug}/${id}`\n  }\n\n  if (globalConfig) {\n    draftsEnabled = Boolean(globalConfig.versions?.drafts)\n    docEndpoint = `/globals/${globalSlug}`\n  }\n\n  const [data, setData] = React.useState<any>(initialData)\n  const [draft, setDraft] = React.useState<boolean>(searchParams.get('draft') === 'true')\n  const [locale, setLocale] = React.useState<string>(searchParams?.get('locale') || code)\n  const [depth, setDepth] = React.useState<string>(\n    searchParams.get('depth') || defaultDepth.toString(),\n  )\n  const [authenticated, setAuthenticated] = React.useState<boolean>(true)\n  const [fullscreen, setFullscreen] = React.useState<boolean>(false)\n\n  const params = new URLSearchParams({\n    depth,\n    draft: String(draft),\n    locale,\n  }).toString()\n\n  const fetchURL = `${serverURL}${apiRoute}${docEndpoint}?${params}`\n\n  React.useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const res = await fetch(fetchURL, {\n          credentials: authenticated ? 'include' : 'omit',\n          headers: {\n            'Accept-Language': i18n.language,\n          },\n          method: 'GET',\n        })\n\n        try {\n          const json = await res.json()\n          setData(json)\n        } catch (error) {\n          toast.error('Error parsing response')\n          console.error(error) // eslint-disable-line no-console\n        }\n      } catch (error) {\n        toast.error('Error making request')\n        console.error(error) // eslint-disable-line no-console\n      }\n    }\n\n    void fetchData()\n  }, [i18n.language, fetchURL, authenticated])\n\n  return (\n    <Gutter\n      className={[baseClass, fullscreen && `${baseClass}--fullscreen`].filter(Boolean).join(' ')}\n      right={false}\n    >\n      <SetDocumentStepNav\n        collectionSlug={collectionSlug}\n        globalLabel={globalConfig?.label}\n        globalSlug={globalSlug}\n        id={id}\n        pluralLabel={collectionConfig ? collectionConfig?.labels?.plural : undefined}\n        useAsTitle={collectionConfig ? collectionConfig?.admin?.useAsTitle : undefined}\n        view=\"API\"\n      />\n      <div className={`${baseClass}__configuration`}>\n        <div className={`${baseClass}__api-url`}>\n          <span className={`${baseClass}__label`}>\n            API URL <CopyToClipboard value={fetchURL} />\n          </span>\n          <a href={fetchURL} rel=\"noopener noreferrer\" target=\"_blank\">\n            {fetchURL}\n          </a>\n        </div>\n        <Form\n          initialState={{\n            authenticated: {\n              initialValue: authenticated || false,\n              valid: true,\n              value: authenticated || false,\n            },\n            depth: {\n              initialValue: Number(depth || 0),\n              valid: true,\n              value: Number(depth || 0),\n            },\n            draft: {\n              initialValue: draft || false,\n              valid: true,\n              value: draft || false,\n            },\n            locale: {\n              initialValue: locale,\n              valid: true,\n              value: locale,\n            },\n          }}\n        >\n          <div className={`${baseClass}__form-fields`}>\n            <div className={`${baseClass}__filter-query-checkboxes`}>\n              {draftsEnabled && (\n                <CheckboxField\n                  field={{\n                    name: 'draft',\n                    label: t('version:draft'),\n                  }}\n                  onChange={() => setDraft(!draft)}\n                  path=\"draft\"\n                />\n              )}\n              <CheckboxField\n                field={{\n                  name: 'authenticated',\n                  label: t('authentication:authenticated'),\n                }}\n                onChange={() => setAuthenticated(!authenticated)}\n                path=\"authenticated\"\n              />\n            </div>\n            {localeOptions && <LocaleSelector localeOptions={localeOptions} onChange={setLocale} />}\n            <NumberField\n              field={{\n                name: 'depth',\n                admin: {\n                  step: 1,\n                },\n                label: t('general:depth'),\n                max: 10,\n                min: 0,\n              }}\n              onChange={(value) => setDepth(value?.toString())}\n              path=\"depth\"\n            />\n          </div>\n        </Form>\n      </div>\n      <div className={`${baseClass}__results-wrapper`}>\n        <div className={`${baseClass}__toggle-fullscreen-button-container`}>\n          <button\n            aria-label=\"toggle fullscreen\"\n            className={`${baseClass}__toggle-fullscreen-button`}\n            onClick={() => setFullscreen(!fullscreen)}\n            type=\"button\"\n          >\n            <MinimizeMaximizeIcon isMinimized={!fullscreen} />\n          </button>\n        </div>\n        <div className={`${baseClass}__results`}>\n          <RenderJSON object={data} />\n        </div>\n      </div>\n    </Gutter>\n  )\n}\n"],"mappings":"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","ignoreList":[]}