{"version":3,"file":"EnabledRelationshipsCondition.js","names":["c","_c","useAuth","useConfig","useEntityVisibility","React","filterRichTextCollections","collections","options","filter","slug","admin","enableRichTextRelationship","upload","visibleEntities","includes","uploads","Boolean","EnabledRelationshipsCondition","props","$","FallbackComponent","children","rest","t0","undefined","config","t1","user","t2","map","_temp","enabledCollectionSlugs","useState","length","t3","_jsx","t4","cloneElement"],"sources":["../../../../../src/features/relationship/client/utils/EnabledRelationshipsCondition.tsx"],"sourcesContent":["'use client'\nimport type { ClientCollectionConfig, ClientUser, VisibleEntities } from 'payload'\n\nimport { useAuth, useConfig, useEntityVisibility } from '@payloadcms/ui'\nimport * as React from 'react'\n\ntype Options = {\n  uploads: boolean\n  user: ClientUser\n  visibleEntities?: VisibleEntities\n}\n\ntype FilteredCollectionsT = (\n  collections: ClientCollectionConfig[],\n  options?: Options,\n) => ClientCollectionConfig[]\n\nconst filterRichTextCollections: FilteredCollectionsT = (collections, options) => {\n  return collections.filter(({ slug, admin: { enableRichTextRelationship }, upload }) => {\n    if (!options?.visibleEntities?.collections.includes(slug)) {\n      return false\n    }\n\n    if (options?.uploads) {\n      return enableRichTextRelationship && Boolean(upload) === true\n    }\n\n    return upload ? false : enableRichTextRelationship\n  })\n}\n\nexport const EnabledRelationshipsCondition: React.FC<{\n  children: any\n  FallbackComponent?: React.FC\n  uploads?: boolean\n}> = (props) => {\n  const { children, FallbackComponent, uploads = false, ...rest } = props\n  const {\n    config: { collections },\n  } = useConfig()\n  const { user } = useAuth()\n  const { visibleEntities } = useEntityVisibility()\n\n  const [enabledCollectionSlugs] = React.useState(() =>\n    filterRichTextCollections(collections, { uploads, user: user!, visibleEntities }).map(\n      ({ slug }) => slug,\n    ),\n  )\n\n  if (!enabledCollectionSlugs.length) {\n    return FallbackComponent ? <FallbackComponent {...rest} /> : null\n  }\n\n  return React.cloneElement(children, { ...rest, enabledCollectionSlugs })\n}\n"],"mappings":"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","ignoreList":[]}