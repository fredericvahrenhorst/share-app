{"version":3,"file":"index.js","names":["buildFormState","React","getDocPreferences","getDocumentData","getDocumentPermissions","CreateFirstUserClient","CreateFirstUserView","initPageResult","locale","req","payload","collections","config","admin","user","userSlug","collectionConfig","auth","authOptions","loginWithUsername","data","collectionSlug","slug","docPreferences","docPermissions","state","formState","code","operation","renderAllFields","schemaPath","skipValidation","_jsxs","className","_jsx","t","initialState"],"sources":["../../../src/views/CreateFirstUser/index.tsx"],"sourcesContent":["import type { AdminViewServerProps } from 'payload'\n\nimport { buildFormState } from '@payloadcms/ui/utilities/buildFormState'\nimport React from 'react'\n\nimport { getDocPreferences } from '../Document/getDocPreferences.js'\nimport { getDocumentData } from '../Document/getDocumentData.js'\nimport { getDocumentPermissions } from '../Document/getDocumentPermissions.js'\nimport { CreateFirstUserClient } from './index.client.js'\nimport './index.scss'\n\nexport async function CreateFirstUserView({ initPageResult }: AdminViewServerProps) {\n  const {\n    locale,\n    req,\n    req: {\n      payload: {\n        collections,\n        config: {\n          admin: { user: userSlug },\n        },\n      },\n    },\n  } = initPageResult\n\n  const collectionConfig = collections?.[userSlug]?.config\n  const { auth: authOptions } = collectionConfig\n  const loginWithUsername = authOptions.loginWithUsername\n\n  // Fetch the data required for the view\n  const data = await getDocumentData({\n    collectionSlug: collectionConfig.slug,\n    locale,\n    payload: req.payload,\n    req,\n    user: req.user,\n  })\n\n  // Get document preferences\n  const docPreferences = await getDocPreferences({\n    collectionSlug: collectionConfig.slug,\n    payload: req.payload,\n    user: req.user,\n  })\n\n  // Get permissions\n  const { docPermissions } = await getDocumentPermissions({\n    collectionConfig,\n    data,\n    req,\n  })\n\n  // Build initial form state from data\n  const { state: formState } = await buildFormState({\n    collectionSlug: collectionConfig.slug,\n    data,\n    docPermissions,\n    docPreferences,\n    locale: locale?.code,\n    operation: 'create',\n    renderAllFields: true,\n    req,\n    schemaPath: collectionConfig.slug,\n    skipValidation: true,\n  })\n\n  return (\n    <div className=\"create-first-user\">\n      <h1>{req.t('general:welcome')}</h1>\n      <p>{req.t('authentication:beginCreateFirstUser')}</p>\n      <CreateFirstUserClient\n        docPermissions={docPermissions}\n        docPreferences={docPreferences}\n        initialState={formState}\n        loginWithUsername={loginWithUsername}\n        userSlug={userSlug}\n      />\n    </div>\n  )\n}\n"],"mappings":";AAEA,SAASA,cAAc,QAAQ;AAC/B,OAAOC,KAAA,MAAW;AAElB,SAASC,iBAAiB,QAAQ;AAClC,SAASC,eAAe,QAAQ;AAChC,SAASC,sBAAsB,QAAQ;AACvC,SAASC,qBAAqB,QAAQ;AAGtC,OAAO,eAAeC,oBAAoB;EAAEC;AAAc,CAAwB;EAChF,MAAM;IACJC,MAAM;IACNC,GAAG;IACHA,GAAA,EAAK;MACHC,OAAA,EAAS;QACPC,WAAW;QACXC,MAAA,EAAQ;UACNC,KAAA,EAAO;YAAEC,IAAA,EAAMC;UAAQ;QAAE;MAC1B;IACF;EACF,CACF,GAAGR,cAAA;EAEJ,MAAMS,gBAAA,GAAmBL,WAAA,GAAcI,QAAA,CAAS,EAAEH,MAAA;EAClD,MAAM;IAAEK,IAAA,EAAMC;EAAW,CAAE,GAAGF,gBAAA;EAC9B,MAAMG,iBAAA,GAAoBD,WAAA,CAAYC,iBAAiB;EAEvD;EACA,MAAMC,IAAA,GAAO,MAAMjB,eAAA,CAAgB;IACjCkB,cAAA,EAAgBL,gBAAA,CAAiBM,IAAI;IACrCd,MAAA;IACAE,OAAA,EAASD,GAAA,CAAIC,OAAO;IACpBD,GAAA;IACAK,IAAA,EAAML,GAAA,CAAIK;EACZ;EAEA;EACA,MAAMS,cAAA,GAAiB,MAAMrB,iBAAA,CAAkB;IAC7CmB,cAAA,EAAgBL,gBAAA,CAAiBM,IAAI;IACrCZ,OAAA,EAASD,GAAA,CAAIC,OAAO;IACpBI,IAAA,EAAML,GAAA,CAAIK;EACZ;EAEA;EACA,MAAM;IAAEU;EAAc,CAAE,GAAG,MAAMpB,sBAAA,CAAuB;IACtDY,gBAAA;IACAI,IAAA;IACAX;EACF;EAEA;EACA,MAAM;IAAEgB,KAAA,EAAOC;EAAS,CAAE,GAAG,MAAM1B,cAAA,CAAe;IAChDqB,cAAA,EAAgBL,gBAAA,CAAiBM,IAAI;IACrCF,IAAA;IACAI,cAAA;IACAD,cAAA;IACAf,MAAA,EAAQA,MAAA,EAAQmB,IAAA;IAChBC,SAAA,EAAW;IACXC,eAAA,EAAiB;IACjBpB,GAAA;IACAqB,UAAA,EAAYd,gBAAA,CAAiBM,IAAI;IACjCS,cAAA,EAAgB;EAClB;EAEA,oBACEC,KAAA,CAAC;IAAIC,SAAA,EAAU;4BACbC,IAAA,CAAC;gBAAIzB,GAAA,CAAI0B,CAAC,CAAC;qBACXD,IAAA,CAAC;gBAAGzB,GAAA,CAAI0B,CAAC,CAAC;qBACVD,IAAA,CAAC7B,qBAAA;MACCmB,cAAA,EAAgBA,cAAA;MAChBD,cAAA,EAAgBA,cAAA;MAChBa,YAAA,EAAcV,SAAA;MACdP,iBAAA,EAAmBA,iBAAA;MACnBJ,QAAA,EAAUA;;;AAIlB","ignoreList":[]}