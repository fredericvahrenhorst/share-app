{"version":3,"file":"index.js","names":["getTranslation","hoistQueryParamsToAnd","transformColumnsToPreferences","React","Fragment","useCallback","useEffect","useState","Pill","useEffectEvent","ChevronIcon","useAuth","useConfig","ListQueryProvider","useServerFunctions","TableColumnsProvider","useTranslation","AnimateHeight","ColumnSelector","useDocumentDrawer","RelationshipProvider","AddNewButton","DrawerLink","RelationshipTablePagination","baseClass","RelationshipTable","props","AfterInput","allowCreate","BeforeInput","disableTable","field","fieldPath","filterOptions","initialData","initialDataFromProps","initialDrawerData","Label","parent","relationTo","Table","setTable","config","getEntityConfig","permissions","docs","Array","isArray","reduce","acc","doc","id","i18n","t","query","setQuery","openColumnSelector","setOpenColumnSelector","collectionConfig","collectionSlug","isPolymorphic","selectedCollection","setSelectedCollection","undefined","isLoadingTable","setIsLoadingTable","data","setData","columnState","setColumnState","getTableState","renderTable","newQuery","limit","String","defaultLimit","admin","pagination","sort","defaultSort","where","defaultColumns","map","accessor","active","newData","state","newColumnState","NewTable","columns","enableRowSelections","orderableFieldName","orderable","collection","name","renderRowTypes","tableAppearance","handleTableRender","DocumentDrawer","closeDrawer","isDrawerOpen","openDrawer","onDrawerSave","args","foundDocIndex","findIndex","withNewOrUpdatedDoc","newDocs","onDrawerCreate","onDrawerDelete","filter","canCreate","collections","create","_jsxs","className","_jsx","buttonStyle","icon","label","onClick","direction","pillStyle","size","length","labels","plural","singular","modifySearchParams","onQueryChange","replaceAll","LinkedCellOverride","height","slug","onSave"],"sources":["../../../src/elements/RelationshipTable/index.tsx"],"sourcesContent":["'use client'\nimport { getTranslation } from '@payloadcms/translations'\nimport {\n  type CollectionSlug,\n  type Column,\n  type JoinFieldClient,\n  type ListQuery,\n  type PaginatedDocs,\n  type Where,\n} from 'payload'\nimport { hoistQueryParamsToAnd, transformColumnsToPreferences } from 'payload/shared'\nimport React, { Fragment, useCallback, useEffect, useState } from 'react'\n\nimport type { DocumentDrawerProps } from '../DocumentDrawer/types.js'\n\nimport { Pill } from '../../elements/Pill/index.js'\nimport { useEffectEvent } from '../../hooks/useEffectEvent.js'\nimport { ChevronIcon } from '../../icons/Chevron/index.js'\nimport { useAuth } from '../../providers/Auth/index.js'\nimport { useConfig } from '../../providers/Config/index.js'\nimport { ListQueryProvider } from '../../providers/ListQuery/index.js'\nimport { useServerFunctions } from '../../providers/ServerFunctions/index.js'\nimport { TableColumnsProvider } from '../../providers/TableColumns/index.js'\nimport { useTranslation } from '../../providers/Translation/index.js'\nimport { AnimateHeight } from '../AnimateHeight/index.js'\nimport { ColumnSelector } from '../ColumnSelector/index.js'\nimport { useDocumentDrawer } from '../DocumentDrawer/index.js'\nimport { RelationshipProvider } from '../Table/RelationshipProvider/index.js'\nimport { AddNewButton } from './AddNewButton.js'\nimport { DrawerLink } from './cells/DrawerLink/index.js'\nimport './index.scss'\nimport { RelationshipTablePagination } from './Pagination.js'\n\nconst baseClass = 'relationship-table'\n\ntype RelationshipTableComponentProps = {\n  readonly AfterInput?: React.ReactNode\n  readonly allowCreate?: boolean\n  readonly BeforeInput?: React.ReactNode\n  readonly disableTable?: boolean\n  readonly field: JoinFieldClient\n  readonly fieldPath?: string\n  readonly filterOptions?: Where\n  readonly initialData?: PaginatedDocs\n  readonly initialDrawerData?: DocumentDrawerProps['initialData']\n  readonly Label?: React.ReactNode\n  readonly parent?: {\n    collectionSlug: CollectionSlug\n    id: number | string\n    joinPath: string\n  }\n  readonly relationTo: string | string[]\n}\n\nexport const RelationshipTable: React.FC<RelationshipTableComponentProps> = (props) => {\n  const {\n    AfterInput,\n    allowCreate = true,\n    BeforeInput,\n    disableTable = false,\n    field,\n    fieldPath,\n    filterOptions,\n    initialData: initialDataFromProps,\n    initialDrawerData,\n    Label,\n    parent,\n    relationTo,\n  } = props\n  const [Table, setTable] = useState<React.ReactNode>(null)\n  const { config, getEntityConfig } = useConfig()\n\n  const { permissions } = useAuth()\n\n  const [initialData] = useState<PaginatedDocs>(() => {\n    if (initialDataFromProps) {\n      return {\n        ...initialDataFromProps,\n        docs: Array.isArray(initialDataFromProps.docs)\n          ? initialDataFromProps.docs.reduce((acc, doc) => {\n              if (typeof doc === 'string') {\n                return [\n                  ...acc,\n                  {\n                    id: doc,\n                  },\n                ]\n              }\n              return [...acc, doc]\n            }, [])\n          : [],\n      }\n    }\n  })\n\n  const { i18n, t } = useTranslation()\n\n  const [query, setQuery] = useState<ListQuery>()\n  const [openColumnSelector, setOpenColumnSelector] = useState(false)\n\n  const [collectionConfig] = useState(() => getEntityConfig({ collectionSlug: relationTo }))\n\n  const isPolymorphic = Array.isArray(relationTo)\n\n  const [selectedCollection, setSelectedCollection] = useState(\n    isPolymorphic ? undefined : relationTo,\n  )\n  const [isLoadingTable, setIsLoadingTable] = useState(!disableTable)\n  const [data, setData] = useState<PaginatedDocs>(initialData)\n  const [columnState, setColumnState] = useState<Column[]>()\n\n  const { getTableState } = useServerFunctions()\n\n  const renderTable = useCallback(\n    async (docs?: PaginatedDocs['docs']) => {\n      const newQuery: ListQuery = {\n        limit: String(field?.defaultLimit || collectionConfig?.admin?.pagination?.defaultLimit),\n        sort: field.defaultSort || collectionConfig?.defaultSort,\n        ...(query || {}),\n        where: { ...(query?.where || {}) },\n      }\n\n      if (filterOptions) {\n        newQuery.where = hoistQueryParamsToAnd(newQuery.where, filterOptions)\n      }\n\n      // map columns from string[] to CollectionPreferences['columns']\n      const defaultColumns = field.admin.defaultColumns\n        ? field.admin.defaultColumns.map((accessor) => ({\n            accessor,\n            active: true,\n          }))\n        : undefined\n\n      const {\n        data: newData,\n        state: newColumnState,\n        Table: NewTable,\n      } = await getTableState({\n        collectionSlug: relationTo,\n        columns: transformColumnsToPreferences(query?.columns) || defaultColumns,\n        docs,\n        enableRowSelections: false,\n        orderableFieldName:\n          !field.orderable || Array.isArray(field.collection)\n            ? undefined\n            : `_${field.collection}_${field.name}_order`,\n        parent,\n        query: newQuery,\n        renderRowTypes: true,\n        tableAppearance: 'condensed',\n      })\n\n      setData(newData)\n      setTable(NewTable)\n      setColumnState(newColumnState)\n      setIsLoadingTable(false)\n    },\n    [\n      field.defaultLimit,\n      field.defaultSort,\n      field.admin.defaultColumns,\n      field.collection,\n      field.name,\n      field.orderable,\n      collectionConfig?.admin?.pagination?.defaultLimit,\n      collectionConfig?.defaultSort,\n      query,\n      filterOptions,\n      getTableState,\n      relationTo,\n      parent,\n    ],\n  )\n\n  const handleTableRender = useEffectEvent((query: ListQuery, disableTable: boolean) => {\n    if (!disableTable && (!Table || query)) {\n      void renderTable()\n    }\n  })\n\n  useEffect(() => {\n    handleTableRender(query, disableTable)\n  }, [query, disableTable])\n\n  const [DocumentDrawer, , { closeDrawer, isDrawerOpen, openDrawer }] = useDocumentDrawer({\n    collectionSlug: selectedCollection,\n  })\n\n  const onDrawerSave = useCallback<DocumentDrawerProps['onSave']>(\n    (args) => {\n      const foundDocIndex = data?.docs?.findIndex((doc) => doc.id === args.doc.id)\n      let withNewOrUpdatedDoc: PaginatedDocs['docs'] = undefined\n\n      if (foundDocIndex !== -1) {\n        const newDocs = [...data.docs]\n        newDocs[foundDocIndex] = args.doc\n        withNewOrUpdatedDoc = newDocs\n      } else {\n        withNewOrUpdatedDoc = [args.doc, ...data.docs]\n      }\n\n      void renderTable(withNewOrUpdatedDoc)\n    },\n    [data?.docs, renderTable],\n  )\n\n  const onDrawerCreate = useCallback<DocumentDrawerProps['onSave']>(\n    (args) => {\n      closeDrawer()\n\n      void onDrawerSave(args)\n    },\n    [closeDrawer, onDrawerSave],\n  )\n\n  const onDrawerDelete = useCallback<DocumentDrawerProps['onDelete']>(\n    (args) => {\n      const newDocs = data.docs.filter((doc) => doc.id !== args.id)\n      void renderTable(newDocs)\n    },\n    [data?.docs, renderTable],\n  )\n\n  const canCreate =\n    allowCreate !== false &&\n    permissions?.collections?.[isPolymorphic ? relationTo[0] : relationTo]?.create\n\n  useEffect(() => {\n    if (isPolymorphic && selectedCollection) {\n      openDrawer()\n    }\n  }, [selectedCollection, openDrawer, isPolymorphic])\n\n  useEffect(() => {\n    if (isPolymorphic && !isDrawerOpen && selectedCollection) {\n      setSelectedCollection(undefined)\n    }\n    // eslint-disable-next-line react-compiler/react-compiler -- TODO: fix\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isDrawerOpen])\n\n  return (\n    <div className={baseClass}>\n      <div className={`${baseClass}__header`}>\n        {Label}\n        <div className={`${baseClass}__actions`}>\n          <AddNewButton\n            allowCreate={allowCreate !== false}\n            baseClass={baseClass}\n            buttonStyle=\"none\"\n            className={`${baseClass}__add-new${isPolymorphic ? '-polymorphic' : ' doc-drawer__toggler'}`}\n            collections={config.collections}\n            i18n={i18n}\n            icon={isPolymorphic ? 'plus' : undefined}\n            label={i18n.t('fields:addNew')}\n            onClick={isPolymorphic ? setSelectedCollection : openDrawer}\n            permissions={permissions}\n            relationTo={relationTo}\n          />\n          <Pill\n            aria-controls={`${baseClass}-columns`}\n            aria-expanded={openColumnSelector}\n            className={`${baseClass}__toggle-columns ${\n              openColumnSelector ? `${baseClass}__buttons-active` : ''\n            }`}\n            icon={<ChevronIcon direction={openColumnSelector ? 'up' : 'down'} />}\n            onClick={() => setOpenColumnSelector(!openColumnSelector)}\n            pillStyle=\"light\"\n            size=\"small\"\n          >\n            {t('general:columns')}\n          </Pill>\n        </div>\n      </div>\n      {BeforeInput}\n      {isLoadingTable ? (\n        <p>{t('general:loading')}</p>\n      ) : (\n        <Fragment>\n          {data?.docs && data.docs.length === 0 && (\n            <div className={`${baseClass}__no-results`}>\n              <p>\n                {i18n.t('general:noResults', {\n                  label: isPolymorphic\n                    ? i18n.t('general:documents')\n                    : getTranslation(collectionConfig?.labels?.plural, i18n),\n                })}\n              </p>\n              <AddNewButton\n                allowCreate={canCreate}\n                baseClass={baseClass}\n                collections={config.collections}\n                i18n={i18n}\n                label={i18n.t('general:createNewLabel', {\n                  label: isPolymorphic\n                    ? i18n.t('general:document')\n                    : getTranslation(collectionConfig?.labels?.singular, i18n),\n                })}\n                onClick={isPolymorphic ? setSelectedCollection : openDrawer}\n                permissions={permissions}\n                relationTo={relationTo}\n              />\n            </div>\n          )}\n          {data?.docs && data.docs.length > 0 && (\n            <RelationshipProvider>\n              <ListQueryProvider\n                columns={transformColumnsToPreferences(columnState)}\n                data={data}\n                defaultLimit={\n                  field.defaultLimit ?? collectionConfig?.admin?.pagination?.defaultLimit\n                }\n                defaultSort={field.defaultSort ?? collectionConfig?.defaultSort}\n                modifySearchParams={false}\n                onQueryChange={setQuery}\n                orderableFieldName={\n                  !field.orderable || Array.isArray(field.collection)\n                    ? undefined\n                    : `_${field.collection}_${fieldPath.replaceAll('.', '_')}_order`\n                }\n              >\n                <TableColumnsProvider\n                  collectionSlug={isPolymorphic ? relationTo[0] : relationTo}\n                  columnState={columnState}\n                  LinkedCellOverride={\n                    <DrawerLink onDrawerDelete={onDrawerDelete} onDrawerSave={onDrawerSave} />\n                  }\n                >\n                  <AnimateHeight\n                    className={`${baseClass}__columns`}\n                    height={openColumnSelector ? 'auto' : 0}\n                    id={`${baseClass}-columns`}\n                  >\n                    <div className={`${baseClass}__columns-inner`}>\n                      {collectionConfig && (\n                        <ColumnSelector collectionSlug={collectionConfig.slug} />\n                      )}\n                    </div>\n                  </AnimateHeight>\n                  {Table}\n                  <RelationshipTablePagination />\n                </TableColumnsProvider>\n              </ListQueryProvider>\n            </RelationshipProvider>\n          )}\n        </Fragment>\n      )}\n      {AfterInput}\n      <DocumentDrawer initialData={initialDrawerData} onSave={onDrawerCreate} />\n    </div>\n  )\n}\n"],"mappings":"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","ignoreList":[]}